tempC<-dcast(temp,NodeID+DateTime+ch+measure+variable~value)
library(ggplot2)
library(reshape2)
datDir<-"/Users/jac/Documents/projects/plantWater/lysim/Lysimeter/logger/data/20170617/"
datFiles<-grep(".csv",list.files(datDir),value=TRUE)
setwd(datDir)
nNodes<-length(datFiles)
Dat<-data.frame(NodeID=numeric(0),unixtime=numeric(0),BatV=numeric(0),BoardTemp=numeric(0),ch1Kg=numeric(0),ch1Temp=numeric(0),ch2Kg=numeric(0),ch2Temp=numeric(0),ch3Kg=numeric(0),ch3Temp=numeric(0),ch4Kg=numeric(0),ch4Temp=numeric(0),ch5Kg=numeric(0),ch5Temp=numeric(0),ch6Kg=numeric(0),ch6Temp=numeric(0),ch7Kg=numeric(0),ch7Temp=numeric(0),ch8Kg=numeric(0),ch8Temp=numeric(0),count=numeric(0),DateTime=character())
a=1
for(a in 1:nNodes){
tempDat<-read.csv(datFiles[a],header=FALSE,colClasses = rep("numeric",21))
names(tempDat)<-c("NodeID","unixtime","BatV","BoardTemp","ch1Kg","ch1Temp","ch2Kg","ch2Temp","ch3Kg","ch3Temp","ch4Kg","ch4Temp","ch5Kg","ch5Temp","ch6Kg","ch6Temp","ch7Kg","ch7Temp","ch8Kg","ch8Temp","count")
tempDat$DateTime<-as.POSIXct(tempDat$unixtime, origin="1970-01-01",tz="UTC") #rtc is set to UTC
# head(tempDat)
# tail(tempDat)
Dat<-rbind(Dat,tempDat)
}
tail(Dat)
unique(Dat$NodeID)
Datm<-melt(data = Dat, id.vars = c("NodeID","unixtime","BatV","BoardTemp","count","DateTime"))
Datm$ch<-factor(substr(Datm$variable,3,3))
Datm$measure<-factor(substr(Datm$variable,4,stop=7))
Datm2<-melt(Datm,id.vars=c("NodeID","DateTime",'ch','measure'),measure.vars="value")
str(Datm2)
temp<-Datm2[1:1000,]
tempC<-dcast(temp,NodeID+DateTime+ch+measure+variable~value)
tempC<-dcast(temp,NodeID+DateTime+ch+variable~measure+value)
tempC<-dcast(temp,NodeID+DateTime+ch+variable~measure)
tempC<-dcast(temp,NodeID+DateTime+ch+variable~value)
tempC<-dcast(temp,NodeID+DateTime+ch+variable+measure~value)
tempC<-dcast(temp,NodeID+DateTime~ch+variable+measure+value)
tempC<-dcast(temp,value~NodeID+DateTime+ch+variable+measure)
names(ChickWeight) <- tolower(names(ChickWeight))
chick_m <- melt(ChickWeight, id=2:4, na.rm=TRUE)
ChickWeight
dcast(chick_m, time ~ variable, mean) # average effect of time
dcast(chick_m, diet ~ variable, mean) # average effect of diet
acast(chick_m, diet ~ time, mean) # average effect of diet & time
dcast(chick_m, diet + chick ~ time)
acast(chick_m, diet + chick ~ time)
tempC<-dcast(temp,NodeID+DateTime~ch+variable+measure)
tempC<-dcast(temp,measure~NodeID+DateTime+ch+variable)
tempC<-dcast(temp,measure~NodeID+DateTime+ch)
tempC<-dcast(temp,NodeID+DateTime~ch+measure)
tempC<-dcast(temp,NodeID+DateTime+ch~measure)
tempC<-dcast(temp,NodeID+DateTime+ch+measure)
tempC<-dcast(temp,NodeID+DateTime+ch+measure~value)
str(Datm2)
tempC<-dcast(temp,measure~DateTime)
tempC<-dcast(temp,DateTime~measure)
tempC<-dcast(temp,DateTime~measure+value)
tempC<-dcast(temp,DateTime+measure~value)
tempC<-dcast(temp,DateTime~measure)
tempC<-dcast(temp,DateTime+measure~measure)
tempC<-dcast(temp,NodeID+DateTime+measure~measure)
tempC<-dcast(temp,NodeID+DateTime+ch+measure~measure)
tempC<-dcast(temp,NodeID+DateTime+ch+measure~value)
tempC<-dcast(temp,NodeID+unixtime+ch+measure~value)
str(Datm2)
temp<-Datm2[Datm2$measure=="Temp",]
kg<-Datm2[Datm2$measure=="Kg",]
names(temp)[6]<-"Temp"
names(kg)[6]<-"Kg"
Dat2<-merge(temp[,c(-4,-5)],kg[,c(-4,-5)])
str(Datm)
Datm2<-melt(Datm,id.vars=c("NodeID","DateTime","BatV","BoardTemp","count",'ch','measure'),measure.vars="value")
str(Datm2)
temp<-Datm2[Datm2$measure=="Temp",]
names(temp)[names(temp)=='value']<-"Temp"
names(kg)[names(kg)=='value']<-"Kg"
Datm2<-melt(Datm,id.vars=c("NodeID","DateTime","BatV","BoardTemp","count",'ch','measure'),measure.vars="value")
temp<-Datm2[Datm2$measure=="Temp",]
names(temp)[names(temp)=='value']<-"Temp"
kg<-Datm2[Datm2$measure=="Kg",]
names(kg)[names(kg)=='value']<-"Kg"
Dat2<-merge(temp[,-c(7,8)],kg[,-c(7,8)])
str(Dat2)
tail(Dat2)
Dat2$NodeID<-as.factor(Dat2$NodeID)
str(Dat2)
tail(Dat2)
Dat2$Kg<-Dat2$Kg/10000
str(Dat2)
tail(Dat2)
head(Dat2)
Dat2<-Dat2[Dat2$DateTime>"2016-01-01",]
str(Dat2)
tail(Dat2)
head(Dat2)
ggplot(Dat2,aes(x=DateTime,y=Kg))+geom_line()
ggplot(Dat2,aes(x=DateTime,y=Kg))+geom_line()+ylim(0,20)
ggplot(Dat2,aes(x=DateTime,y=Kg))+geom_line()+ylim(0,20)+facet_wrap(~NodeID)
ggplot(Dat2,aes(x=DateTime,y=Kg))+geom_line()+ylim(0,20)+facet_grid(ch~NodeID)
str(Datm)
tail(Dat)
Dat$ch1Diff<-diff(Dat$ch1Kg)
Dat$ch1Diff<-c(0,diff(Dat$ch1Kg))
Dat$ch2Diff<-c(0,diff(Dat$ch2Kg))
Dat$ch3Diff<-c(0,diff(Dat$ch3Kg))
Dat$ch4Diff<-c(0,diff(Dat$ch4Kg))
Dat$ch5Diff<-c(0,diff(Dat$ch5Kg))
Dat$ch6Diff<-c(0,diff(Dat$ch6Kg))
Dat$ch7Diff<-c(0,diff(Dat$ch7Kg))
Dat$ch8Diff<-c(0,diff(Dat$ch8Kg))
Datm<-melt(data = Dat, id.vars = c("NodeID","unixtime","BatV","BoardTemp","count","DateTime"))
Datm$ch<-factor(substr(Datm$variable,3,3))
Datm$measure<-factor(substr(Datm$variable,4,stop=7))
str(Datm)
Datm2<-melt(Datm,id.vars=c("NodeID","DateTime","BatV","BoardTemp","count",'ch','measure'),measure.vars="value")
str(Datm2)
temp<-Datm2[Datm2$measure=="Temp",]
names(temp)[names(temp)=='value']<-"Temp"
kg<-Datm2[Datm2$measure=="Kg",]
names(kg)[names(kg)=='value']<-"Kg"
diffkg<-Datm2[Datm2$measure=="Diff",]
names(diffkg)[names(diffkg)=='value']<-"diffKg"
Dat2<-merge(temp[,-c(7,8)],kg[,-c(7,8)],diffkg[,-c(7,8)])
Dat2<-merge(temp[,-c(7,8)],kg[,-c(7,8)])
Dat2<-merge(Dat2,kg[,-c(7,8)])
Dat2<-merge(temp[,-c(7,8)],kg[,-c(7,8)])
Dat2<-merge(Dat2,diffkg[,-c(7,8)])
Dat2$Kg<-Dat2$Kg/10000
Dat2$diffKg<-Dat2$diffKg/10000
Dat2<-Dat2[Dat2$DateTime>"2016-01-01",]
str(Dat2)
tail(Dat2)
head(Dat2)
ggplot(Dat2,aes(x=DateTime,y=diffKg))+geom_line()+ylim(-0.1,0.1)+facet_grid(ch~NodeID)
ggplot(Dat2[Dat2$NodeID=='100.1',],aes(x=DateTime,y=diffKg))+geom_line()+ylim(-0.1,0.1)+facet_wrap(ch)
ggplot(Dat2[Dat2$NodeID=='100.1',],aes(x=DateTime,y=diffKg))+geom_line()+ylim(-0.1,0.1)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.1',],aes(x=DateTime,y=diffKg))+geom_line()+ylim(-0.2,0.2)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.1',],aes(x=DateTime,y=diffKg))+geom_line()+ylim(-0.5,0.5)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.2',],aes(x=DateTime,y=diffKg))+geom_line()+ylim(-0.5,0.5)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.2',],aes(x=DateTime,y=Kg))+geom_line()+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.2',],aes(x=DateTime,y=Kg))+geom_line()+ylim(0,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.2',],aes(x=DateTime,y=Kg))+geom_line()+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.2',],aes(x=DateTime,y=Kg))+geom_line()+ylim(7,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.3',],aes(x=DateTime,y=Kg))+geom_line()+ylim(7,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.5',],aes(x=DateTime,y=Kg))+geom_line()+ylim(7,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.5',],aes(x=DateTime,y=Kg))+geom_line()+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.6',],aes(x=DateTime,y=Kg))+geom_line()+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.6',],aes(x=DateTime,y=BatV))+geom_line()+ylim(5,15)
ggplot(Dat2[Dat2$NodeID=='100.5',],aes(x=DateTime,y=BatV))+geom_line()+ylim(5,15)
ggplot(Dat2[Dat2$NodeID=='100.1',],aes(x=DateTime,y=BatV))+geom_line()+ylim(5,15)
ggplot(Dat2[Dat2$NodeID=='100.6',],aes(x=DateTime,y=BatV))+geom_line()+ylim(5,15)
ggplot(Dat2[Dat2$NodeID=='100.7',],aes(x=DateTime,y=Kg))+geom_line()+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.8',],aes(x=DateTime,y=Kg))+geom_line()+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.9',],aes(x=DateTime,y=Kg))+geom_line()+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.9'&Dat2$DateTime>'2017-06-15',],aes(x=DateTime,y=Kg))+geom_line()+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.9'&Dat2$DateTime>'2017-06-14',],aes(x=DateTime,y=Kg))+geom_line()+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.9'&Dat2$DateTime>'2017-06-14',],aes(x=DateTime,y=diffKg))+geom_line()+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.9'&Dat2$DateTime>'2017-06-14',],aes(x=DateTime,y=diffKg))+geom_line()+ylim(-0.5,0.5)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.9'&Dat2$DateTime>'2017-06-14',],aes(x=DateTime,y=diffKg))+geom_line()+ylim(-0.2,0.2)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.9'&Dat2$DateTime>'2017-06-14',],aes(x=DateTime,y=Kg))+geom_line()+ylim(5,15)+facet_wrap(~ch)
library(zoo)
str(Dat2)
library(plyr)
library(dplyr)
str(Dat2)
unloadNamespace(dplyr)
detach(dplyr)
detach("dplyr")
detach(unload=TRUE,"dplyr")
detach(unload=TRUE,"package:dplyr")
library(plyr)
str(Dat2)
Dat3<-ddply(Dat2,.(NodeID,DateTime,ch),summarise,rm20min=rollmean(Kg,4,fill=NA),rm1hr=rollmean(rm20min,3,fill=NA))
Dat3<-ddply(Dat2,.(NodeID,DateTime,ch),summarise,rm20min=rollmean(x=Kg,k=4,fill=NA),rm1hr=rollmean(x=rm20min,k=3,fill=NA))
rollmean(x=Dat2$Kg[Dat2$NodeID=='100.1'&Dat2$ch==1,],k=3,fill=NA)
rollmean(x=Dat2$Kg[Dat2$NodeID=='100.1'&Dat2$ch==1],k=3,fill=NA)
rollmean(x=Dat2$Kg[Dat2$NodeID=='100.2'&Dat2$ch==1],k=3,fill=NA)
rollmean(x=Dat2$Kg[Dat2$NodeID=='100.2'&Dat2$ch==1],k=3,fill=NA,align='right')
rollmean(rollmean(x=Dat2$Kg[Dat2$NodeID=='100.2'&Dat2$ch==1],k=4,fill=NA,align='right'),k=3,fill=NA,align='right')
rollmean(x=rollmean(x=Dat2$Kg[Dat2$NodeID=='100.2'&Dat2$ch==1],k=4,fill=NA,align='right'),k=3,fill=NA,align='right')
rollmean(x=na.omit(rollmean(x=Dat2$Kg[Dat2$NodeID=='100.2'&Dat2$ch==1],k=4,fill=NA,align='right')),k=3,fill=NA,align='right')
rollmean(x=rollmean(x=Dat2$Kg[Dat2$NodeID=='100.2'&Dat2$ch==1],k=4,fill=0,align='right'),k=3,fill=NA,align='right')
Dat3<-ddply(Dat2,.(NodeID,DateTime,ch),summarise,rm20min=rollmean(x=Kg,k=4,fill=0),rm1hr=rollmean(x=rm20min,k=3,fill=0))
Dat3<-ddply(Dat2,.(NodeID,DateTime,ch),summarise,rm20min=rollmean(x=Kg,k=4,fill=0))
Dat3<-ddply(Dat2,.(NodeID,DateTime,ch),summarise,rm20min=rollapplyr(Kg,4,mean))
Dat3<-ddply(Dat2,.(NodeID,DateTime,ch),mutate,rm20min=rollapplyr(Kg,4,mean))
str(Dat2)
Dat3<-ddply(Dat2,.(NodeID,DateTime,ch),mutate,rm20min=function(kg) rollmean(Kg,k=4,fill=NA))
Dat3<-ddply(Dat2,.(NodeID,DateTime,ch),summarize,rm20min=function(kg) rollmean(Kg,k=4,fill=NA))
Dat3<-ddply(Dat2,.(NodeID,DateTime,ch),summarize,rm20min=rollmean(Kg,k=4,fill=NA))
Dat3<-ddply(Dat2,.(NodeID,DateTime,ch),summarize,rm20min=mean(kg))
Dat3
Dat3<-ddply(Dat2,.(NodeID,DateTime,ch),mutate,rm20min=mean(Kg))
Dat3<-ddply(Dat2,.(NodeID,DateTime,ch),mutate,rm20min=rollmean(Kg,4))
Dat3<-ddply(Dat2,.(NodeID,DateTime,ch),mutate,rm20min=rollapply(data=Kg,width=4,mean))
Dat3<-ddply(Dat2,.(NodeID,DateTime,ch),mutate,rm20min=rollapply(data=Kg,width=4,(mean))
tail(Dat2)
head(Dat2)
ggplot(Dat2[Dat2$NodeID=='100.6',],aes(x=DateTime,y=BatV))+geom_line()+ylim(5,15)
ggplot(Dat2,aes(x=DateTime,y=diffKg))+geom_line()+ylim(-0.1,0.1)+facet_grid(ch~NodeID)
ggplot(Dat2[Dat2$NodeID=='100.1',],aes(x=DateTime,y=diffKg))+geom_line()+ylim(-0.5,0.5)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.2',],aes(x=DateTime,y=diffKg))+geom_line()+ylim(-0.5,0.5)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.2',],aes(x=DateTime,y=Kg))+geom_line()+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.5',],aes(x=DateTime,y=Kg))+geom_line()+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.6',],aes(x=DateTime,y=Kg))+geom_line()+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.7',],aes(x=DateTime,y=Kg))+geom_line()+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.8',],aes(x=DateTime,y=Kg))+geom_line()+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.9',],aes(x=DateTime,y=Kg))+geom_line()+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.9'&Dat2$DateTime>'2017-06-14',],aes(x=DateTime,y=Kg))+geom_line()+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.9'&Dat2$DateTime>'2017-06-14',],aes(x=DateTime,y=diffKg))+geom_line()+ylim(-0.2,0.2)+facet_wrap(~ch)
ggplot(dat[-1,],aes(x=DateTime,y=ch1Kg))+geom_line()+geom_line(aes(y=ch2Kg),colour=2)+geom_line(aes(y=ch3Kg),colour=3)+geom_line(aes(y=ch4Kg),colour=4)+geom_line(aes(y=ch5Kg),colour=5)+geom_line(aes(y=ch6Kg),colour=6)+geom_line(aes(y=ch7Kg),colour=7)+geom_line(aes(y=ch8Kg),colour=8)
ggplot(dat[-1,],aes(x=DateTime,y=ch1Temp))+geom_line()+geom_line(aes(y=ch2Temp),colour=2)+geom_line(aes(y=ch3Temp),colour=3)+geom_line(aes(y=ch4Temp),colour=4)+geom_line(aes(y=ch5Temp),colour=5)+geom_line(aes(y=ch6Temp),colour=6)+geom_line(aes(y=ch7Temp),colour=7)+geom_line(aes(y=ch8Temp),colour=8)
ggplot(dat[-1,],aes(x=DateTime,y=ch1Temp))+geom_line()+geom_line(aes(y=ch2Temp),color=2)
testdat<-data.frame(xx=1:8,yy=1:8)
ggplot(testdat,aes(x=xx,y=yy))+geom_point(colour=1:8,size=12)+geom_text(aes(x=xx,y=yy),label=1:8)
Dat3<-ddply(Dat2,.(NodeID,DateTime,ch),mutate,rm20min=rollapply(data=Kg,width=4,(mean)))
Dat3<-ddply(Dat2,.(NodeID,DateTime,ch),mutate,rm20min=rollapply(data=Kg,width=4,FUN=(mean)))
Dat3<-ddply(Dat2,.(NodeID,DateTime,ch),mutate,rm20min=rollapply(data=Kg,width=4,FUN=mean))
library(caTools)
Dat3<-ddply(Dat2,.(NodeID,DateTime,ch),mutate,rm20min=runmean(x=Kg,k=4))
Dat3$rm20min[Dat2$NodeID=='100.2'&Dat2$ch==1]
cbind(Dat3$kg[Dat2$NodeID=='100.2'&Dat2$ch==1],Dat3$rm20min[Dat2$NodeID=='100.2'&Dat2$ch==1])
cbind(Dat3$Kg[Dat2$NodeID=='100.2'&Dat2$ch==1],Dat3$rm20min[Dat2$NodeID=='100.2'&Dat2$ch==1])
Dat3<-ddply(Dat2,.(NodeID,ch),mutate,rm20min=runmean(x=Kg,k=4))
cbind(Dat3$Kg[Dat2$NodeID=='100.2'&Dat2$ch==1],Dat3$rm20min[Dat2$NodeID=='100.2'&Dat2$ch==1])
Dat3<-ddply(Dat2,.(NodeID,ch),mutate,rm20min=rollapply(data=Kg,width=4,FUN=mean))
Dat3<-ddply(Dat2,.(NodeID,ch),mutate,rm20min=rollapply(data=Kg,width=4,FUN=meanfill=NA))
Dat3<-ddply(Dat2,.(NodeID,ch),mutate,rm20min=rollapply(data=Kg,width=4,FUN=mean,fill=NA))
cbind(Dat3$Kg[Dat2$NodeID=='100.2'&Dat2$ch==1],Dat3$rm20min[Dat2$NodeID=='100.2'&Dat2$ch==1])
head(Dat2)
head(Dat2[Dat2$NodeID=='100.2'&Dat2$ch=1,])
head(Dat2[Dat2$NodeID=='100.2'&Dat2$ch==1,])
head(Dat3[Dat2$NodeID=='100.2'&Dat2$ch==1,])
head(Dat3[Dat2$NodeID=='100.1'&Dat2$ch==1,])
Dat3[Dat2$NodeID=='100.2'&Dat2$ch==1,]
Dat3[Dat2$NodeID=='100.2'&Dat2$ch==1,c(1,2,8,10,9)]
str(Dat2)
arrange(Dat2,NodeID,DateTime)
Dat2a<-arrange(Dat2,NodeID,DateTime)
head(Dat2)
head(Dat2a)
Dat2a<-arrange(Dat2,NodeID,ch,DateTime)
head(Dat2a)
Dat3<-ddply(Dat2,.(NodeID,ch),mutate,rm20min=runmean(x=Kg,k=4,fill=NA))
Dat3<-ddply(Dat2,.(NodeID,ch),mutate,rm20min=rollapply(data=Kg,width=4,FUN=mean,fill=NA))
cbind(Dat3$Kg[Dat3$NodeID=='100.2'&Dat3$ch==1],Dat3$rm20min[Dat3$NodeID=='100.2'&Dat3$ch==1])
head(Dat3[Dat3$NodeID=='100.2'&Dat3$ch==1,])
Dat3[Dat2$NodeID=='100.2'&Dat2$ch==1,c(1,2,8,10,9)]
Dat3<-ddply(Dat2a,.(NodeID,ch),mutate,rm20min=rollapply(data=Kg,width=4,FUN=mean,fill=NA))
head(Dat3[Dat3$NodeID=='100.2'&Dat3$ch==1,])
Dat3[Dat2$NodeID=='100.2'&Dat2$ch==1,c(1,2,8,10,9)]
Dat3[Dat3$NodeID=='100.2'&Dat3$ch==1,c(1,2,8,10,9)]
Dat3<-ddply(Dat2a,.(NodeID,ch),mutate,rm20min=rollapply(data=Kg,width=4,FUN=mean,fill=0),rm1hr=rollapply(data=Kg,width=3,FUN=mean,fill=NA))
Dat3$hrDiff<-cbind(0,diff(rm1hr))
Dat3$hrDiff<-cbind(0,diff(Dat3$rm1hr))
Dat3$hrDiff<-cbind(0,0,diff(Dat3$rm1hr))
Dat3$hrDiff<-cbind(0,0,0,diff(Dat3$rm1hr))
Dat3$hrDiff<-c(0,diff(Dat3$rm1hr))
head(Dat3)
Dat3$hrDiff<-c(NA,diff(Dat3$rm1hr))
head(Dat3)
head(Dat3);tail(Dat3)
Dat3<-ddply(Dat2a,.(NodeID,ch),mutate,rm20min=rollapply(data=Kg,width=4,FUN=mean,fill=0,align="right"),rm1hr=rollapply(data=Kg,width=3,FUN=mean,fill=NA,align="right"))
Dat3$hrDiff<-c(NA,diff(Dat3$rm1hr))
head(Dat3);tail(Dat3)
Dat3<-ddply(Dat2a,.(NodeID,ch),mutate,rm20min=rollapply(data=Kg,width=4,FUN=mean,fill=0,align="right"),rm1hr=rollapply(data=rm20min,width=3,FUN=mean,fill=NA,align="right"))
Dat3$hrDiff<-c(NA,diff(Dat3$rm1hr))
head(Dat3);tail(Dat3)
ggplot(Dat2[Dat2$NodeID=='100.2',],aes(x=DateTime,y=Kg))+geom_line()+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.2',],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm1hr),color='red')+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat2[Dat3$NodeID=='100.2',],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm1hr),color='red')+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat3[Dat3$NodeID=='100.2',],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm1hr),color='red')+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat3[Dat3$NodeID=='100.2',],aes(x=DateTime,y=diffKg))+geom_line()+geom_line(aes(y=hrDiff),color='red')+ylim(-0.1,0.1)+facet_wrap(~ch)
ggplot(Dat3[Dat3$NodeID=='100.2'&Dat3$ch==1,],aes(x=DateTime,y=diffKg))+geom_line()+geom_line(aes(y=hrDiff),color='red')+ylim(-0.1,0.1)
ggplot(Dat3[Dat3$NodeID=='100.2'&Dat3$ch==1,],aes(x=DateTime,y=diffKg*1000))+geom_line()+geom_line(aes(y=hrDiff*1000),color='red')+ylim(-0.1,0.1)
ggplot(Dat3[Dat3$NodeID=='100.2'&Dat3$ch==1,],aes(x=DateTime,y=diffKg*1000))+geom_line()+geom_line(aes(y=hrDiff*1000),color='red')+ylim(-100,100)
ggplot(Dat3[Dat3$NodeID=='100.2'&Dat3$ch==1,],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm1hr),color='red')+ylim(5,15)
ggplot(Dat3[Dat3$NodeID=='100.2'&Dat3$ch==1,],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm1hr),color='red')+ylim(9,10)
ggplot(Dat3[Dat3$NodeID=='100.2'&Dat3$ch==1,],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm1hr),color='red')+ylim(9,10.5)
ggplot(Dat3[Dat3$NodeID=='100.2'&Dat3$ch==1,],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+ylim(9,10.5)
Dat3<-ddply(Dat2a,.(NodeID,ch),mutate,rm20min=rollapply(data=Kg,width=4,FUN=mean,fill=0,align="right"),rm1hr=rollapply(data=rm20min,width=3,FUN=mean,fill=0,align="right"),rm1day=rollapply(data=rm1hr,width=24,FUN=mean,fill=NA,align="right"))
Dat3$hrDiff<-c(NA,diff(Dat3$rm1hr))
head(Dat3);tail(Dat3)
ggplot(Dat3[Dat3$NodeID=='100.2'&Dat3$ch==1,],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(9,10.5)
ggplot(Dat3[Dat3$NodeID=='100.1'&Dat3$ch==7,],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(9,10.5)
ggplot(Dat3[Dat3$NodeID=='100.1'&Dat3$ch==7,],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(5,15)
ggplot(Dat3[Dat3$NodeID=='100.1'&Dat3$ch==7,],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(11,13)
ggplot(Dat3[Dat3$NodeID=='100.1'&Dat3$ch==7,],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(11,14)
ggplot(Dat3[Dat3$NodeID=='100.1'&Dat3$ch==8,],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(11,14)
ggplot(Dat3[Dat3$NodeID=='100.1'&Dat3$ch==7,],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(11,14)
ggplot(Dat3[Dat3$NodeID=='100.5'&Dat3$ch==1,],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(11,14)
ggplot(Dat3[Dat3$NodeID=='100.5'&Dat3$ch==1,],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(5,14)
ggplot(Dat3[Dat3$NodeID=='100.7'&Dat3$ch==1,],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(5,14)
ggplot(Dat3[Dat3$NodeID=='100.7'&Dat3$ch==1,],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(7,9)
ggplot(Dat3[Dat3$NodeID=='100.7',],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+facet_wrap(~ch)
ggplot(Dat3[Dat3$NodeID=='100.7',],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat3[Dat3$NodeID=='100.8',],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat3[Dat3$NodeID=='100.8',],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(7,15)+facet_wrap(~ch)
ggplot(Dat3[Dat3$NodeID=='100.8',],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(7,13)+facet_wrap(~ch)
ggplot(Dat3[Dat3$NodeID=='100.9',],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(7,13)+facet_wrap(~ch)
ggplot(Dat3[Dat3$NodeID=='100.8',],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(7,13)+facet_wrap(~ch)
ggplot(Dat3[Dat3$NodeID=='100.2',],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(7,13)+facet_wrap(~ch)
ggplot(Dat3[Dat3$NodeID=='100.3',],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(7,13)+facet_wrap(~ch)
ggplot(Dat3[Dat3$NodeID=='100.6',],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(7,13)+facet_wrap(~ch)
ggplot(Dat3[Dat3$NodeID=='100.1',],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(7,13)+facet_wrap(~ch)
scale1hr<-scan()
plot(scale1hr,type='l')
plot(scale1hr*1000,type='l')
scale1hr$diff<-scale1hr-mean(scale1hr[1:10])
scale1hr<-data.frame(dat=scan())
plot(scale1hr*1000,type='l')
plot(scale1hr$dat*1000,type='l')
scale1hr$diff<-scale1hr$dat-mean(scale1hr$dat[1:10])
plot(scale1hr$diff*1000,type='l')
scale1hr<-data.frame(dat=read.table("/Users/jac/Documents/projects/plantWater/lysim/Lysimeter/node/serialcaptures/CoolTerm Capture 2017-06-18 15-28-07.txt"))
scale1hr<-data.frame(dat=read.table("/Users/jac/Documents/projects/plantWater/lysim/Lysimeter/node/serialcaptures/CoolTerm Capture 2017-06-18 15-28-07.txt")[,1])
plot(scale1hr$dat*1000,type='l')
scale1hr$diff<-scale1hr$dat-mean(scale1hr$dat[1:10])
plot(scale1hr$diff*1000,type='l')
datDir<-"/Users/jac/Documents/projects/plantWater/lysim/Lysimeter/logger/data/20170618/"
datFiles<-grep(".csv",list.files(datDir),value=TRUE)
setwd(datDir)
nNodes<-length(datFiles)
Dat<-data.frame(NodeID=numeric(0),unixtime=numeric(0),BatV=numeric(0),BoardTemp=numeric(0),ch1Kg=numeric(0),ch1Temp=numeric(0),ch2Kg=numeric(0),ch2Temp=numeric(0),ch3Kg=numeric(0),ch3Temp=numeric(0),ch4Kg=numeric(0),ch4Temp=numeric(0),ch5Kg=numeric(0),ch5Temp=numeric(0),ch6Kg=numeric(0),ch6Temp=numeric(0),ch7Kg=numeric(0),ch7Temp=numeric(0),ch8Kg=numeric(0),ch8Temp=numeric(0),count=numeric(0),DateTime=character())
a=1
for(a in 1:nNodes){
tempDat<-read.csv(datFiles[a],header=FALSE,colClasses = rep("numeric",21))
names(tempDat)<-c("NodeID","unixtime","BatV","BoardTemp","ch1Kg","ch1Temp","ch2Kg","ch2Temp","ch3Kg","ch3Temp","ch4Kg","ch4Temp","ch5Kg","ch5Temp","ch6Kg","ch6Temp","ch7Kg","ch7Temp","ch8Kg","ch8Temp","count")
tempDat$DateTime<-as.POSIXct(tempDat$unixtime, origin="1970-01-01",tz="UTC") #rtc is set to UTC
# head(tempDat)
# tail(tempDat)
Dat<-rbind(Dat,tempDat)
}
tail(Dat)
unique(Dat$NodeID)
Dat$ch1Diff<-c(0,diff(Dat$ch1Kg))
Dat$ch2Diff<-c(0,diff(Dat$ch2Kg))
Dat$ch3Diff<-c(0,diff(Dat$ch3Kg))
Dat$ch4Diff<-c(0,diff(Dat$ch4Kg))
Dat$ch5Diff<-c(0,diff(Dat$ch5Kg))
Dat$ch6Diff<-c(0,diff(Dat$ch6Kg))
Dat$ch7Diff<-c(0,diff(Dat$ch7Kg))
Dat$ch8Diff<-c(0,diff(Dat$ch8Kg))
Datm<-melt(data = Dat, id.vars = c("NodeID","unixtime","BatV","BoardTemp","count","DateTime"))
Datm$ch<-factor(substr(Datm$variable,3,3))
Datm$measure<-factor(substr(Datm$variable,4,stop=7))
str(Datm)
Datm2<-melt(Datm,id.vars=c("NodeID","DateTime","BatV","BoardTemp","count",'ch','measure'),measure.vars="value")
str(Datm2)
temp<-Datm2[Datm2$measure=="Temp",]
names(temp)[names(temp)=='value']<-"Temp"
kg<-Datm2[Datm2$measure=="Kg",]
names(kg)[names(kg)=='value']<-"Kg"
diffkg<-Datm2[Datm2$measure=="Diff",]
names(diffkg)[names(diffkg)=='value']<-"diffKg"
Dat2<-merge(temp[,-c(7,8)],kg[,-c(7,8)])
Dat2<-merge(Dat2,diffkg[,-c(7,8)])
Dat2$NodeID<-as.factor(Dat2$NodeID)
Dat2$Kg<-Dat2$Kg/10000
Dat2$diffKg<-Dat2$diffKg/10000
Dat2<-Dat2[Dat2$DateTime>"2016-01-01",]
str(Dat2)
head(Dat2)
Dat2a<-arrange(Dat2,NodeID,ch,DateTime)
head(Dat2a)
Dat3<-ddply(Dat2a,.(NodeID,ch),mutate,rm20min=rollapply(data=Kg,width=4,FUN=mean,fill=0,align="right"),rm1hr=rollapply(data=rm20min,width=3,FUN=mean,fill=0,align="right"),rm1day=rollapply(data=rm1hr,width=24,FUN=mean,fill=NA,align="right"))
Dat3$hrDiff<-c(NA,diff(Dat3$rm1hr))
head(Dat3);tail(Dat3)
ggplot(Dat2[Dat2$NodeID=='100.6',],aes(x=DateTime,y=BatV))+geom_line()+ylim(11,13)
ggplot(Dat2,aes(x=DateTime,y=BatV))+geom_line()+ylim(11,13)+facet_wrap(~NodeID)
ggplot(Dat2,aes(x=DateTime,y=BatV))+geom_line()+ylim(12,13)+facet_wrap(~NodeID)
ggplot(Dat2,aes(x=DateTime,y=BoardTemp))+geom_line()+ylim(12,13)+facet_wrap(~NodeID)
ggplot(Dat2,aes(x=DateTime,y=BoardTemp))+geom_line()+ylim(0,25)+facet_wrap(~NodeID)
tail(Dat3)
ggplot(Dat2,aes(x=DateTime,y=BoardTemp))+geom_line()+ylim(-5,25)+facet_wrap(~NodeID)
ggplot(Dat2,aes(x=DateTime,y=BoardTemp))+geom_line()+ylim(-10,25)+facet_wrap(~NodeID)
ggplot(Dat2,aes(x=DateTime,y=diffKg))+geom_line()+ylim(-0.1,0.1)+facet_grid(ch~NodeID)
ggplot(Dat2[Dat2$NodeID=='100.1',],aes(x=DateTime,y=diffKg))+geom_line()+ylim(-0.5,0.5)+facet_wrap(~ch)
ggplot(Dat3,aes(x=DateTime,y=BatV))+geom_line()+ylim(12,13)+facet_wrap(~NodeID)
ggplot(Dat3,aes(x=DateTime,y=BoardTemp))+geom_line()+ylim(-10,25)+facet_wrap(~NodeID)
ggplot(Dat3,aes(x=DateTime,y=diffKg))+geom_line()+ylim(-0.1,0.1)+facet_grid(ch~NodeID)
ggplot(Dat3[Dat3$NodeID=='100.1',],aes(x=DateTime,y=diffKg))+geom_line()+ylim(-0.5,0.5)+facet_wrap(~ch)
max(Dat3$DateTime[Dat3$NodeID=='100.1'])
max(Dat3$DateTime[Dat3$NodeID=='100.2'])
max(Dat3$DateTime[Dat3$NodeID=='100.3'])
max(Dat3$DateTime[Dat3$NodeID=='100.5'])
max(Dat3$DateTime[Dat3$NodeID=='100.6'])
max(Dat3$DateTime[Dat3$NodeID=='100.7'])
max(Dat3$DateTime[Dat3$NodeID=='100.8'])
max(Dat3$DateTime[Dat3$NodeID=='100.9'])
ggplot(Dat3[Dat2$NodeID=='100.2',],aes(x=DateTime,y=Kg))+geom_line()+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.7',],aes(x=DateTime,y=Kg))+geom_line()+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.8',],aes(x=DateTime,y=Kg))+geom_line()+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.9',],aes(x=DateTime,y=Kg))+geom_line()+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.9',],aes(x=DateTime,y=Kg))+geom_line()+ylim(8,13)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.9'&Dat2$DateTime>'2017-06-14',],aes(x=DateTime,y=Kg))+geom_line()+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat2[Dat2$NodeID=='100.9'&Dat2$DateTime>'2017-06-14',],aes(x=DateTime,y=diffKg))+geom_line()+ylim(-0.2,0.2)+facet_wrap(~ch)
ggplot(Dat3[Dat3$NodeID=='100.2'&Dat3$ch==1,],aes(x=DateTime,y=diffKg*1000))+geom_line()+geom_line(aes(y=hrDiff*1000),color='red')+ylim(-100,100)
ggplot(Dat3[Dat3$NodeID=='100.2'&Dat3$ch==1,],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(9,10.5)
ggplot(Dat3[Dat3$NodeID=='100.9'&Dat3$ch==8,],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(9,10.5)
ggplot(Dat3[Dat3$NodeID=='100.9'&Dat3$ch==8,],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(9,12.5)
ggplot(Dat3[Dat3$NodeID=='100.9'&Dat3$ch==8,],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(12,13)
ggplot(Dat3[Dat3$NodeID=='100.9'&Dat3$ch==7,],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(12,13)
ggplot(Dat3[Dat3$NodeID=='100.1'&Dat3$ch==7,],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(11,14)
ggplot(Dat3[Dat3$NodeID=='100.7'&Dat3$ch==1,],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(7,9)
ggplot(Dat3[Dat3$NodeID=='100.7',],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(5,15)+facet_wrap(~ch)
ggplot(Dat3[Dat3$NodeID=='100.8',],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(7,13)+facet_wrap(~ch)
ggplot(Dat3[Dat3$NodeID=='100.9',],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(7,13)+facet_wrap(~ch)
ggplot(Dat3[Dat3$NodeID=='100.2',],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(7,13)+facet_wrap(~ch)
ggplot(Dat3[Dat3$NodeID=='100.1',],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(7,13)+facet_wrap(~ch)
ggplot(Dat3[Dat3$NodeID=='100.9',],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(7,13)+facet_wrap(~ch)
ggplot(Dat3[Dat3$NodeID=='100.9'&Dat3$DateTime>'2017-06-16',],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(7,13)+facet_wrap(~ch)
ggplot(Dat3[Dat3$NodeID=='100.9'&Dat3$DateTime>'2017-06-15',],aes(x=DateTime,y=Kg))+geom_line()+geom_line(aes(y=rm20min),color='blue')+geom_line(aes(y=rm1hr),color='red')+geom_line(aes(y=rm1day),color='green')+ylim(7,13)+facet_wrap(~ch)
as.POSIXct(1497979721, origin="1970-01-01",tz="UTC")
as.POSIXct(1497950915, origin="1970-01-01",tz="UTC")
as.POSIXct(1497950915, origin="1970-01-01",tz="UTC")
as.POSIXct(1497950915, origin="1970-01-01",tz="UTC")
as.POSIXct(1497951052, origin="1970-01-01",tz="UTC")
as.POSIXct(1497950915, origin="1970-01-01",tz="UTC")
as.POSIXct(1497980385, origin="1970-01-01",tz="UTC")
as.POSIXct(1497980385, origin="1970-01-01",tz="UTC")
